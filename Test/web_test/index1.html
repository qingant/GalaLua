<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>webframework 测试结果</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link href="stylesheet.css" rel="stylesheet"  type="text/css">
<script src="js/esl.js"></script>
<script src="js/jquery.js"></script>
</head>
<body>
    <div ID="header">
    <h1 id="h1size">
    DEMONSTRATION
    </h1>
    <div id="menu">
        <p style="text-align:center;font-size:22px;margin-top:5px;font-family:Times; ">Frequent</p>
    </div>
    <select  id="choose">
        <option value="1000">60f/min</option>
        <option value="2000">30f/min</option>
        <option value="5000">12f/min</option>
    </select>
    <br/>
    </div>
<div id="CompleteTotal" class="backGround"></div>
<div id="CompleteProcess" class="backGround"></div>
<div id="TPSStatistic" class="backGround"></div>
<script>

var complete_statistic_data  = [1000,1000,100,10,50,40]; // 完成情况统计数据
var complete_process_data = [ 3, 7, 10, 13, 15, 18, 21, 24, 27, 34]; //完成度数据
var tps_data = [25,32,41,29,17,23,36,37,40,28,25,34,42,32,35,34,39,31,37,29,33,32,31,36,33,35,29,16,9];//第二个表的数据
var tpsy = [25,32,41,29,17,23,36,37,40,28,25,34,42,32,35];//第二个表的数据
var tpsx = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]//第二个图横坐标输入
var tps_average_data = [31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25,31.25];//平均值2

var freq=1000;

require.config({
        paths:{
            echarts:'./js/echarts',
            'echarts/chart/bar' : './js/echarts',
            'echarts/chart/line': './js/echarts'
        }
    });


//var optionGraph = {
//                title : {
//                 text: 'Commands Processed'
//                },
//                tooltip : {
//                    trigger: 'axis'
//                },
//                legend: {
//                    data:['Commands Processed']
//                },
//                toolbox: {
//                    show : true,
//                    feature : {
//                        mark : true,
//                        dataView : {readOnly: false},
//                        magicType:['line', 'bar'],
//                        restore : true,
//                        saveAsImage : true
//                    }
//                },
//                calculable : true,
//                xAxis : [
//                    {
//                        type : 'category',
//                        boundaryGap:false,
//                        data : barData
//                    }
//                ],
//                yAxis : [
//                    {
//                        type : 'value',
//                        splitArea : {show : true}
//                    }
//                ],
//                series : [{ //                        name:'Commands Processed', //                        type:'bar', //                        data:barData,
//                        itemStyle:{
//                        normal:{
//                            color:'#00c3d1',
//                            areaStyle: {
//                            shadowColor : '#0093c1',
//                            type: 'default'
//                        }
//                        }
//                        }
//                    }
//                ]
//            };

var CompleteTotalBar = {
    title : {
        text: '完成情况统计'
    },
    tooltip : {
        trigger: 'axis'
    },
    tooltip : {
        trigger: 'ayis'
    },
    legend: {
        data:["总请求1000"],
    },
    toolbox: {
        show : true,
        feature : {
            mark : true,
            dataView : {readOnly: false},
            magicType:['line', 'bar'],
            restore : true,
            saveAsImage : true
        }
    },
    calculable : true,
    xAxis : [

        {
            type : 'category',
            name : '类别',
            data : ['实际请求','总错误','Recv TimeOut','RecvLine TimeOut','Send TimeOut']
        }
    ],
    yAxis : [
        {
            type : 'value',
            name : '比例',
            splitArea : {show : true}
        }
    ],
    series : [{
            name:'Top Commands',
            type:'bar',
            data: complete_statistic_data,
            itemStyle:{
            normal:{color:'#008ec1'},
            type:'default'
            }
        },
    ]
};

var CompleteProcessBar = {
    title : {
        text: '完成度统计'
    },
    tooltip : {
        trigger: 'axis'
    },
    tooltip : {
        trigger: 'ayis'
    },
    legend: {
        data:[''],
    },
    toolbox: {
        show : true,
        feature : {
            mark : true,
            dataView : {readOnly: false},
            magicType:['line', 'bar'],
            restore : true,
            saveAsImage : true
        }
    },
    calculable : true,
    xAxis : [

        {
            type : 'category',
            name : '完成度',
            data : ['10%','20%','30%','40%','50%','60%','70%','80%','90%','100%']
        }
    ],
    yAxis : [
        {
            type : 'value',
            name : 'Seconds',
            splitArea : {show : true}
        }
    ],
    series : [{
            name:'Top Commands',
            type:'bar',
            data:complete_process_data,
            itemStyle:{
            normal:{color:'#008ec1'},
            type:'default'
            }
        },
    ]
};

var TPSBar = {
    title : {
        text: 'TPS统计'
    },
    tooltip : {
        trigger: 'axis'
    },
    legend: {
        data:['']
    },
    toolbox: {
        show : true,
        feature : {
            mark : true,
            dataView : {readOnly: false},
            magicType:['line', 'bar'],
            restore : true,
            saveAsImage : true
        }
    },
    calculable : true,
    xAxis : [
        {
            type : 'category',
            name : 'Seconds',
            data : tpsx
        }
    ],
    yAxis : [
        {
            type : 'value',
            name : 'TPS',
            splitArea : {show : true}
        }
    ],
    series : [{
        name:'Top Commands',
        type:'bar',
        data:tpsy,
        itemStyle:{
            normal:{color:'#008ec1'},
            type:'default'
        }
    },
    {
        name:'average',
        type:'line',
        data:tps_average_data,
        itemStyle:{
            normal:{color:'orange'},
            type:'default'
        }

    }
    ]
};

var lineChart,graphChart;

require(
    [
        'echarts',
        'echarts/chart/bar',
        'echarts/chart/line'
    ],
    function(ec) {
        CompleteTotalChart = ec.init(document.getElementById('CompleteTotal'));
        CompleteTotalChart.setOption(CompleteTotalBar);
        CompleteProcessChart = ec.init(document.getElementById('CompleteProcess'));
        CompleteProcessChart.setOption(CompleteProcessBar);
        TpsChart = ec.init(document.getElementById('TPSStatistic'));
        TpsChart.setOption(TPSBar);
        var timeTicket;
        clearInterval(timeTicket);
        timeTicket= setInterval(GetData, freq);
    }
);
//
//
//$(document).ready(function() {
//        type: "GET",
//        url: "error_statistics.csv",
//        dataType: "text",
//        success: function(data) {GetCompleteTotalData(data);}
//});
//
function GetCompleteTotalData(){
    $.ajax(
        type: "GET",
        url: "/summary",
        dataType: "text",
        success: function(data) {
            var allCsvLines = allText.split(/\r\n|\n/);
            var tmp = []
            var TotalData = []
            for (var i = 0; i < allCsvLines.length; i++){
                var items = allCsvLines[i].split(',')
                tmp.push(items[1])
                TotalData.push(tmp)
            }
            alert(TotalData)
            complete_statistic_data.push(TotalData)
            CompleteTotalChart.addData([
                [
                    0,        // 系列索引
                    num,// 新增数据
                    true,     // 新增数据是否从队列头部插入
                    false     // 是否增加队列长度，false则自定删除原有数据，队头插入删队尾，队尾插入删队头
                ]
            ]);
        }
    );
}
//
//$(document).ready(function() {
//    $.ajax({
//        type: "GET",
//        url: "complete_statistics.csv",
//        dataType: "text",
//        success: function(data) {GetCompleteProcessData(data);}
//     });
//});
//
//function GetCompleteProcessData(allText) {
//    var allCsvLines = allText.split(/\r\n|\n/);
//    var tmp = allCsvLines[0].split(',');
//    var TotalRequest = tmp[1]
//    var headers = allCsvLines[1].split(',')
//    var CompletePercent = []
//    var CompleteCount = []
//
//    for (var i=2; i < allTextLines.length; i++) {
//        var data = allTextLines[i].split(',');
//        if (data.length == headers.length) {
//            CompletePercent.push(data[0])
//            CompleteCount.push(data[1])
//        }
//    }
//    // alert(CompletePercent);
//    alert(CompleteCount);
//    complete_process_data.push(CompleteCount)
//}
//
//$(document).ready(function() {
//    $.ajax({
//        type: "GET",
//        url: "tps_statistics.csv",
//        dataType: "text",
//        success: function(data) {GetTpsData(data);}
//     });
//});
//
//function GetTpsData(allText) {
//    var allCsvLines = allText.split(/\r\n|\n/);
//    var headers = allCsvLines[0].split(',');
//    var TpsDataX = [];
//    var TpsDataY = [];
//    var tmp = allCsvLines[allCsvLines.length-1].split(',')
//    var TpsAverageData = []
//
//    for (var i=1; i < allCsvLines.length - 1; i++) {
//        var data = allCsvLines[i].split(',');
//        if (data.length == headers.length) {
//            TpsDataX.push(data[i][0]);
//            TpsDataY.push(data[i][1])
//        }
//    }
//    for (var k=1; k < tmp.length; k++){
//        var TpsAverageData[k] = tmp[k]
//    }
//    // alert(TpsDataX);
//    // alert(TpsDataY);
//    tpsx.push(TpsDataX)
//    tpsy.push(TpsDataY)
//}



function GetData(){
    GetCompleteTotalData();
    GetCompleteProcessData();
    GetTpsData();
}

//    function GetCompleteTotalData(){
//    $.ajax({
//        url:'/summary',
//         datatype:'csv',
//        success:function(res){
//          var num =  res.data;
//            CompleteTotalChart.addData([
//                [
//                    0,        // 系列索引
//                    num,// 新增数据
//                    true,     // 新增数据是否从队列头部插入
//                    false     // 是否增加队列长度，false则自定删除原有数据，队头插入删队尾，队尾插入删队头
//                ]
//            ]);
//        }
//        });
//   }
//
//   function GetCompleteProcessData(){
//    $.ajax({
//        url:'/processing',
//        datatype:'csv',
//        success:function(res){
//          var num =  res.data;
//            CompleteProcessChart.addData([
//                [
//                    0,        // 系列索引
//                    num,// 新增数据
//                    true,     // 新增数据是否从队列头部插入
//                    false     // 是否增加队列长度，false则自定删除原有数据，队头插入删队尾，队尾插入删队头
//                ]
//            ]);
//        }
//        });
//   }
//
//
//    function GetTpsData(){
//    $.ajax({
//        url:'/tps',
//         datatype:'csv',
//        success:function(res){
//          var num =  res.data;
//            TpsChart.addData([
//                [
//                    0,        // 系列索引
//                    num,// 新增数据
//                    true,     // 新增数据是否从队列头部插入
//                    false     // 是否增加队列长度，false则自定删除原有数据，队头插入删队尾，队尾插入删队头
//                ]
//            ]);
//        }
//        });
//   }
//
//   function GetInData() {
//    $.ajax({
//        url:'/indicator',
//        datatype:'csv',
//        success:function(res){
//            document.getElementById("umem").innerHTML=res.used_memory+"K";
//            document.getElementById("tkey").innerHTML=res.total_keys+"K";
//            document.getElementById("clients").innerHTML=res.client_count;
//            document.getElementById("cmdproc").innerHTML=res.cmd_processed+"K";
//            document.getElementById("uptime").innerHTML=res.uptime+"S";
//        }
//    })
//   }

</script>
</body>
</html>
